<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>3rd lab</title>
</head>
<body>

<h1> Лабораторная работа № 3. Задания 4, 9 </h1>
Работу выполнил студент группы 5030102/80401, Приймак Евгений.

<h2> Постановка задачи № 4 </h2>
Имеется файл
<code>trades.RData</code>.
В этом файле содержится переменная
<code>trades</code>,
которая представляет собой список из 6 <code>tibble</code>-объектов, каждый из них содержит информацию о
различных экономических показателях (в частности, экспорт и импорт) в различных странах в различные годы
для соответствующего таблице вида грузов. Необходимо:
<ul>
    <li>
        Сначала по этим 6 таблицам построить две, в одной из которых описывается лишь импорт, а в другой --- экспорт.
    </li>

    <li>
        Затем по полученным двум таблицам для груза "Продукты питания, напитки, табак" необходимо получить суммарные
        экспорт и импорт для каждого года; в одном окне построить два графика: для импорта и для экспорта, по одной
        оси --- год, по другой --- суммарный объём.

        <br>

        <i>Требования к графикам</i>: оба должны быть нарисованы в виде ломаной, обозначены разным цветом, подписаны; сделать
        подписи величин экспорта и импорта, отрегулировать их местоположение и размер, чтобы не перекрывались; по-своему
        назвать оси.
    </li>

</ul>


<h2> Реализация задачи № 4 </h2>
<ul>
    <li>
        Первую задачу из постановки выполняет функция
        <br>
        <code>
            get_exp_imp_compound_tables(external_data_path)
        </code>
        <br>
        Она имеет единственный аргумент, он принимает путь до workspace, в результате работы возвращает список
        из двух tibble, в первом из них объединены из всех таблиц данные по экспорту, во втором --- по импорту.
    </li>

    <li>
        Вторую задачу из постановки выполняет функция
        <br>
        <code>
            plot_food_drinks_tobacco(exp_table, imp_table)
        </code>
        <br>
        имеет два аргумента:
        <code>exp_table</code>,
        который принимает таблицу с объединёнными данными по экспорту, и
        <code>imp_table</code>,
        который принимает таблицу с обединёнными данными по импорту.
        Эта функция возвращает график, соответствующий требованиям:
        <br>
        <img src="images/problem_4_result.png"
             alt ="Problem # 4: result"
             width=1280>
        <br>
    </li>
</ul>


<h2> Постановка задачи № 9 </h2>
Имеется файл
<code> ExpImp.RData </code>.
В этом файле содержится переменная
<code>ExpImp</code>
содержащая tibble с данными по импорту, экспорту различных видов грузов для различных регионов РФ (в частности,
для всех субъектов РФ). Необходимо:
<ul>
    <li>
        Привести таблицу к формату tidydata, т. е. чтобы выполнялись три требования: каждый столбец = некоторая одна
        переменная, каждая строка = одно наблюдение, каждая ячейка = значение соответствующей переменной во время
        соответствующего наблюдения.
    </li>

    <li>
        Для каждого региона посчитать суммарные экспорт и импорт металлургической промышленности. По полученным данным:
        <ul>
            <li>
                Изобразить столбчатую диаграмму, где для каждого региона будут показаны суммарные экспорт, импорт.
            </li>

            <li>
                Изобразить столбчатую диаграмму, где для каждого региона будут показаны суммарные экспорт, импорт,
                но столбцы для экспорта и импорта будут расположены по разные стороны от оси.
            </li>

        </ul>

        <i>Требования к диаграммам</i>: экспорт и импорт обозначить разными цветами; во втором случае подписать
        значения экспорта, импорта, подписать долю, которую экспорт, импорт в данном регионе составляют от общих
        экспорта, импорта по всем регионам.
    </li>
</ul>


<h2> Реализация задачи № 9 </h2>
<ul>
    <li>
        Первую задачу выполняет функция
        <code> make_tib_tidy(source_tib) </code>.

        <br>

        <i>Входное значение</i>: с помощью функции
        <code> get_source_tib() </code>
        мы получаем
        <code> tibble </code>,
        содержащий входные данные (правда, эта функция оставляет в нём только строки субъектов РФ, поскольку, например,
        федеральные округа, являются объединением нескольких субъектов, а значит содержат информацию о сумме по некоторым
        субъектам), и передаем этот
        <code> tibble </code>
        описываемой функции.

        <br>

        <i>Действие</i>: она приводит передаваемое значение к формату tidydata, притом следующим образом:
        <ul>
            <li>
                Cначала для каждого вида груза объединяет столбцы импорта, экспорта одного и того же типа груза в один
                столбец, именем этого столбца является название груза.
            </li>

            <li>
                Затем с помощью функции
                <code> pivot_longer </code>
                (пакет
                <code> tidyverse </code>)
                вместо отдельных стобцов для видов грузов создаёт один столбец, значениями в нём являются эти виды.
            </li>

            <li>
                Затем разделяет столбец с объединёнными импортом, экспортом на два столбца: один --- с импортом,
                другой --- с экспортом.
            </li>

            <li>
                Затем с помощью функции
                <code> pivot_longer </code>
                вместо отдельных столбцов для импорта, экспорта создаётся столбец "Операция", в ячейках которого
                находятся значения "Импорт" или "Экспорт".
            </li>
        </ul>

        <br>

        <i>Возвращаемое значение</i>: исходные данные, преобразованные к формату tidydata.
        <code></code>
    </li>

    <li>

    </li>

    <li>
        Вторую задачу решают функции
        <code>plot_graph_1(tidy_tib)</code>
        и
        <code>plot_graph_2(tidy_tib)</code>,
        принимающие на вход tidydata и строящие первый и второй графики. Результаты их работы соответственно:
        <br>
        <img src="images/problem_9_result_1.png"
             width=1280>
        <br>
        <img src="images/problem_9_result_2.png"
             width=1280>
        <br>
    </li>
</ul>

</body>
</html>